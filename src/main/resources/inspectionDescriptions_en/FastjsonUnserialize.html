<html>
<head>
    <title>Fastjson Unserialization Risk Inspection Item</title>
</head>
<body>
<h1>Fastjson Unserialization Risk Inspection Item</h1>
<h2>Vulnerability Type</h2>
<p>
    <strong>Fastjson Unserialization Risk</strong> refers to the potential for deserialization vulnerabilities when using the Fastjson library for JSON parsing. Attackers may craft malicious JSON inputs that exploit deserialization flaws to execute arbitrary code (RCE, Remote Code Execution) on the affected system. This is often due to older versions of Fastjson not properly handling untrusted input.
</p>
<h2>What This Item Checks</h2>
<p>
    This item checks for calls to the <code>parseObject</code> method of the <code>com.alibaba.fastjson.JSON</code> class in the code, identifying potential deserialization risks. Specifically, using <code>parseObject</code> with older versions of Fastjson can introduce such vulnerabilities.
</p>
<h3>Inspection Logic</h3>
<ul>
    <li>If it detects calls to <code>com.alibaba.fastjson.JSON.parseObject</code>, it flags the code as potentially unsafe.</li>
    <li>A warning is displayed at the problematic code locations, advising the developer to check the Fastjson version and consider an upgrade if necessary.</li>
</ul>
<h2>Fix Recommendation</h2>
<p>
    Developers are advised to ensure that they are using the latest version of the Fastjson library to avoid known deserialization vulnerabilities. Upgrading to a version with security patches or using an alternative JSON parsing library is recommended.
</p>
<h3>Quick Fix</h3>
<p>
    This item prompts developers to review their Fastjson version and suggests upgrading to a more secure version to mitigate the risk.
</p>
<h2>Example</h2>
<p>
    For instance, if the code contains the following unsafe call:
</p>
<pre>
<code>
import com.alibaba.fastjson.JSON;

String jsonString = "{...}";
Object obj = JSON.parseObject(jsonString);  // Unsafe
</code>
    </pre>
<p>
    It is recommended that developers ensure they are using a version of Fastjson with the latest security patches or consider using a different parsing method:
</p>
<pre>
<code>
// Ensure using the latest version of Fastjson or replace with a more secure library.
</code>
    </pre>
<h2>References</h2>
<p>
    To learn more about Fastjson deserialization risks and how to address them, you can refer to the following resources:
<ul>
    <li><a href="https://owasp.org/www-community/attacks/Deserialization_of_untrusted_data">OWASP: Deserialization of Untrusted Data</a></li>
    <li><a href="https://github.com/alibaba/fastjson">Fastjson Documentation</a></li>
</ul>
</p>
</body>
</html>
