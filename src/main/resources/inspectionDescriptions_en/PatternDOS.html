<html>
<head>
    <title>Pattern DOS Inspection Item</title>
</head>
<body>
<h1>Pattern DOS Inspection Item</h1>
<h2>Vulnerability Type</h2>
<p>
    <strong>Regular Expression Denial of Service (ReDoS)</strong> is a common vulnerability. When a regular expression has exponential complexity, an attacker can craft input strings that cause the regex to consume excessive CPU resources, slowing down the application or even causing it to become unresponsive.
</p>
<h2>What This Item Checks</h2>
<p>
    This item checks for calls to the <code>Pattern.compile</code> and <code>String.matches</code> methods in the code, determining whether the provided regular expressions have exponential complexity. For example, patterns like <code>([a-z]+)+</code> are considered unsafe because they can potentially lead to ReDoS attacks.
</p>
<h3>Inspection Logic</h3>
<ul>
    <li>If it detects the use of <code>Pattern.compile</code> or <code>String.matches</code> with a regular expression that has potential exponential complexity, it flags the code as potentially unsafe.</li>
    <li>A warning is displayed at the problematic code locations, prompting the developer to make necessary corrections.</li>
</ul>
<h2>Fix Recommendation</h2>
<p>
    To avoid the risk of ReDoS vulnerabilities, it is recommended to avoid using patterns with exponential complexity when working with regular expressions. Developers can simplify their regex patterns or use precompiled and optimized regex libraries.
</p>
<h3>Quick Fix</h3>
<p>
    This item prompts the developer to review the safety of their regular expressions, encouraging the use of safer patterns with lower complexity.
</p>
<h2>Example</h2>
<p>
    For instance, if the code contains the following unsafe regular expressions:
</p>
<pre>
<code>
Pattern.compile("([a-z]+)+");  // Unsafe
"abc".matches("(([a-z])?([a-z]+))+");  // Unsafe
</code>
    </pre>
<p>
    The recommended fix is to modify them into safer regex patterns or decompose parts with high complexity.
</p>
<h2>References</h2>
<p>
    To learn more about ReDoS vulnerabilities and how to address them, you can refer to the following resources:
<ul>
    <li><a href="https://cloud.tencent.com/developer/article/1041326">浅析ReDoS的原理与实践</a></li>
    <li><a href="https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS">OWASP: Regular Expression Denial of Service</a></li>
    <li><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/regex/Pattern.html">Java Pattern Documentation</a></li>
</ul>
</p>
</body>
</html>
