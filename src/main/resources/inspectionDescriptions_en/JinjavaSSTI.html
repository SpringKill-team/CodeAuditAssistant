<html>
<head>
    <title>Jinjava SSTI Inspection Item</title>
</head>
<body>
<h1>Jinjava SSTI Inspection Item</h1>
<h2>Vulnerability Type</h2>
<p>
    <strong>Server-Side Template Injection (SSTI)</strong> is a serious security vulnerability. When user-provided input is directly passed to a template engine for rendering without proper sanitization, an attacker can craft malicious input to execute arbitrary code, access sensitive data on the server, or even take full control of the server.
</p>
<h2>What This Item Checks</h2>
<p>
    This item checks for potential SSTI vulnerabilities when using the <code>render</code> and <code>renderForResult</code> methods of the <code>com.hubspot.jinjava.Jinjava</code> class. These methods can be vulnerable to SSTI if they process uncleaned user input.
</p>
<h3>Inspection Logic</h3>
<ul>
    <li>It scans method calls in the code, looking for the use of the <code>render</code> or <code>renderForResult</code> methods of the <code>Jinjava</code> class. If these methods are used without proper input sanitization, the code is flagged as potentially unsafe.</li>
    <li>A warning is displayed at the location of the problematic code, with suggestions for how to address the issue.</li>
</ul>
<h2>Fix Recommendation</h2>
<p>
    To prevent SSTI vulnerabilities, it is recommended to ensure that user inputs are thoroughly sanitized and validated before rendering the template. Use whitelisting mechanisms or encode inputs to prevent malicious code from being injected into the template.
</p>
<h3>Quick Fix</h3>
<p>
    This item prompts developers to review the source of inputs when rendering templates, ensuring that inputs are safe and not directly using unprocessed user inputs in template rendering.
</p>
<h2>Example</h2>
<p>
    For instance, if the code contains the following unsafe template rendering:
</p>
<pre>
<code>
Jinjava jinjava = new Jinjava();
String result = jinjava.render(template, context);  // Unsafe
</code>
    </pre>
<p>
    It is recommended to validate and sanitize user inputs in the <code>context</code> to ensure they do not contain malicious content.
</p>
<h2>References</h2>
<p>
    To learn more about SSTI vulnerabilities and how to mitigate them, you can refer to the following resources:
<ul>
    <li><a href="https://owasp.org/www-community/attacks/Server_Side_Template_Injection">OWASP: Server-Side Template Injection</a></li>
    <li><a href="https://jinjava.com/">Jinjava Documentation</a></li>
</ul>
</p>
</body>
</html>
