<html>
<head>
    <title>Rhino RCE Inspection Item</title>
</head>
<body>
<h1>Rhino RCE Inspection Item</h1>
<h2>Vulnerability Type</h2>
<p>
    <strong>Remote Code Execution (RCE)</strong> is a critical security vulnerability where attackers can execute arbitrary code through untrusted input, potentially gaining complete control over the server or application. This inspection item focuses on RCE risks when using the Rhino JavaScript engine.
</p>
<h2>What This Item Checks</h2>
<p>
    This item checks for invocations of the <code>evaluateString</code> method in the <code>org.mozilla.javascript.Context</code> class. This method can execute untrusted JavaScript code, which may lead to RCE vulnerabilities.
</p>
<h3>Inspection Logic</h3>
<ul>
    <li>Iterates through a list of monitored classes and methods to identify calls to the <code>evaluateString</code> method within the <code>org.mozilla.javascript.Context</code> class.</li>
    <li>If such a call is detected, it highlights the potentially vulnerable code and prompts the developer to take corrective action.</li>
</ul>
<h2>Fix Recommendation</h2>
<p>
    To mitigate RCE vulnerabilities, it is recommended to avoid using the <code>evaluateString</code> method to execute untrusted JavaScript code. Consider using a safer script execution approach or strictly validating input to ensure that only trusted scripts are executed.
</p>
<h3>Quick Fix</h3>
<p>
    This item prompts the developer to review the code using the <code>evaluateString</code> method, ensuring that no unfiltered input is executed.
</p>
<h2>Example</h2>
<p>
    For instance, if the code contains the following unsafe invocation:
</p>
<pre>
<code>
Context context = Context.enter();
context.evaluateString(scope, "untrustedScript", "sourceName", 1, null);
</code>
    </pre>
<p>
    It is recommended to avoid executing untrusted scripts directly or to use a whitelist mechanism to restrict the scripts that can be executed.
</p>
<h2>References</h2>
<p>
    To learn more about RCE vulnerabilities and how to address them, you can refer to the following resources:
<ul>
    <li><a href="https://owasp.org/www-community/attacks/Remote_Code_Execution">OWASP: Remote Code Execution</a></li>
    <li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Projects/Rhino">Rhino Documentation</a></li>
</ul>
</p>
</body>
</html>
