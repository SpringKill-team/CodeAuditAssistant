<html>
<head>
    <title>Jsoup SSRF Inspection Item</title>
</head>
<body>
<h1>Jsoup SSRF Inspection Item</h1>
<h2>Vulnerability Type</h2>
<p>
    <strong>Server-Side Request Forgery (SSRF)</strong> is a vulnerability where an attacker can trick a server into making HTTP requests to arbitrary destinations. This can lead to the server accessing internal network resources or performing unauthorized actions, posing a serious security threat.
</p>
<h2>What This Item Checks</h2>
<p>
    This item checks for the use of the <code>connect</code> method from the <code>org.jsoup.Jsoup</code> class and the <code>get</code>, <code>post</code>, and <code>execute</code> methods of the <code>org.jsoup.Connection</code> interface. Improper use of these methods may introduce SSRF risks.
</p>
<h3>Inspection Logic</h3>
<ul>
    <li>If it detects calls to <code>Jsoup.connect</code> or the <code>get</code>, <code>post</code>, <code>execute</code> methods of a <code>Connection</code>, it flags the code as potentially vulnerable to SSRF.</li>
    <li>It highlights potential risk locations, prompting developers to review and address the issues.</li>
</ul>
<h2>Fix Recommendation</h2>
<p>
    To prevent SSRF vulnerabilities, it is recommended to validate the URLs used with <code>Jsoup</code>, ensuring they fall within an expected range. Avoid using URLs directly from user input. Implement whitelisting to restrict access to trusted domains, and perform URL formatting and validation.
</p>
<h3>Quick Fix</h3>
<p>
    This item reminds developers to enhance URL validation logic when using these methods, thereby reducing SSRF risks.
</p>
<h2>Example</h2>
<p>
    For instance, if the code contains the following unsafe calls:
</p>
<pre>
<code>
Jsoup.connect(userInputUrl).get();  // Unsafe
connection.execute();  // Potentially unsafe
</code>
    </pre>
<p>
    The recommended fix is to validate the <code>userInputUrl</code> to ensure its source and format are safe before making the request.
</p>
<h2>References</h2>
<p>
    To learn more about SSRF vulnerabilities and how to mitigate them, you can refer to the following resources:
<ul>
    <li><a href="https://owasp.org/www-community/attacks/Server_Side_Request_Forgery">OWASP: Server-Side Request Forgery</a></li>
    <li><a href="https://jsoup.org/">Jsoup Documentation</a></li>
</ul>
</p>
</body>
</html>
