<html>
<head>
    <title>Reflection Invocation Inspection Item</title>
</head>
<body>
<h1>Reflection Invocation Inspection Item</h1>
<h2>Vulnerability Type</h2>
<p>
    <strong>Reflection Invocation Risk</strong> refers to the potential security risks when using Java reflection APIs (such as <code>Method.invoke()</code>, <code>ClassLoader.loadClass()</code>). Attackers may manipulate input parameters to execute unintended classes and methods, leading to remote code execution (RCE) or other security issues.
</p>
<h2>What This Item Checks</h2>
<p>
    This item checks for calls to the following methods:
</p>
<ul>
    <li><code>java.lang.reflect.Method.invoke()</code></li>
    <li><code>java.lang.ClassLoader.loadClass()</code></li>
    <li><code>java.net.URLClassLoader.newInstance()</code></li>
    <li><code>org.codehaus.groovy.runtime.InvokerHelper.invokeMethod()</code></li>
</ul>
<p>
    If the parameters of these methods include unvalidated user input, it can lead to attackers invoking arbitrary methods through reflection, resulting in security vulnerabilities.
</p>
<h2>Fix Recommendation</h2>
<p>
    Developers are advised to validate all input parameters thoroughly when using reflection to avoid directly using user input for method invocation or class loading. Use predefined method calls or restrict the range of accessible classes to minimize security risks.
</p>
<h3>Quick Fix</h3>
<p>
    This item provides quick fix suggestions to help developers identify unsafe reflection calls and remind them to perform input validation.
</p>
<h2>Example</h2>
<p>
    For instance, if the code contains the following unsafe reflection call:
</p>
<pre>
<code>
Method method = someClass.getMethod(methodName, parameterTypes);
method.invoke(instance, userProvidedArgs);  // Unsafe
</code>
    </pre>
<p>
    It is recommended to validate <code>methodName</code> and <code>userProvidedArgs</code> to ensure only trusted inputs are allowed.
</p>
<h2>References</h2>
<p>
    To learn more about reflection risks and mitigation techniques, refer to the following resources:
<ul>
    <li><a href="https://owasp.org/www-community/attacks/Reflection_Attack">OWASP: Reflection Attack</a></li>
    <li><a href="https://docs.oracle.com/javase/tutorial/reflect/">Java Reflection Documentation</a></li>
</ul>
</p>
</body>
</html>
